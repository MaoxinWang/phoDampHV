function [rho50,sigma_z] = rho_SA_SA(input_T1,input_Damp1,input_T2,input_Damp2,typePair)

% Created by Mao-Xin Wang (maoxin_wang@hotmail.com or maoxin.wang@polyu.edu.hk)
% July 2023
%
% Predict correlation coefficient between H-H, H-V, or V-V pair of SAs
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% INPUT
%
%   input_T1     = scalar or matrix of inputted period values (in units of s)
%                  for H1 component (in H-H pair), H component (in H-V pair),
%                  or V1 component (in V-V pair)
%   input_Damp1  = scalar or matrix of inputted damping ratio values
%                  for H1 component (in H-H pair), H component (in H-V pair),
%                  or V1 component (in V-V pair)
%   input_T2     = scalar or matrix of inputted period values (in units of s)
%                  for H2 component (in H-H pair), V component (in H-V pair),
%                  or V2 component (in V-V pair)
%   input_Damp2  = scalar or matrix of inputted damping ratio values
%                  for H2 component (in H-H pair), V component (in H-V pair),
%                  or V2 component (in V-V pair)
%   (Note that the above inputs must be in the same dimension and input_T1
%    must be smaller than input_T2)
%   typePair     = 'H-H' representing the horizontal-horizontal correlation
%                = 'H-V' representing the horizontal-vertical correlation
%                = 'V-V' representing the vertical-vertical correlation
%
% OUTPUT
%
%   rho50        = median correlation coefficient
%   sigma_z      = standard deviation of the z variable
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

X_min = [-4.605 	-0.693 	-4.605 	-0.693];
X_max = [2.303 	3.401 	2.303 	3.401];

%% specify model coefficients
switch typePair
    case 'H-H'
        W = [
            2.170 	1.475 	1.996 	-0.926 	-1.664 	-1.989 	-1.063 	0.542 	-1.825 	-1.890 	-0.051 	-0.707 	-4.832 	0.279 	6.691 	0.610 	-2.322 	0.210 	0.266 	-3.554 	1.435 	1.592 	-2.326 	-0.099 	0.453 	-1.685 	2.837 	1.783 	-1.071 	-4.269 	1.550 	-0.093 	-1.625 	-0.339 	3.852 	4.183 	0.351 	0.365 	1.015 	1.574 	1.433 	0.626 	-0.414 	1.939 	2.992 	5.670 	1.748 	-0.923 	-0.496 	-2.799 	-1.368 	-0.113 	-0.496 	-0.537
            0.078 	0.139 	-0.137 	-0.342 	-0.342 	-0.026 	-0.093 	-0.030 	0.225 	0.200 	-0.032 	-0.022 	0.490 	-0.217 	0.013 	-0.059 	-0.040 	-0.042 	-0.172 	-0.268 	0.337 	0.250 	-0.475 	-0.060 	0.060 	0.128 	-0.203 	-0.180 	0.217 	0.617 	0.071 	0.000 	0.021 	0.187 	-0.182 	0.152 	-0.037 	-0.074 	-0.051 	-0.137 	0.073 	0.350 	0.015 	-0.045 	0.403 	0.198 	0.012 	0.067 	-0.023 	-0.087 	0.095 	-0.237 	0.084 	0.225
            0.703 	-3.436 	-0.602 	0.578 	0.225 	1.325 	-1.358 	-0.579 	-0.114 	0.030 	-2.656 	0.148 	-0.227 	1.876 	0.542 	-0.960 	-0.773 	-5.697 	1.563 	3.373 	-0.731 	0.268 	2.622 	-3.325 	4.423 	-2.620 	-2.088 	2.345 	0.081 	1.021 	0.535 	3.051 	2.256 	-1.897 	-1.458 	-3.884 	1.023 	-2.988 	-2.065 	-0.404 	0.973 	-1.581 	-0.702 	-1.099 	-2.946 	-0.774 	-2.723 	1.632 	1.827 	-0.522 	1.348 	-0.430 	2.265 	-2.163
            -0.017 	0.102 	-0.156 	0.268 	0.110 	-0.021 	0.154 	-0.234 	0.078 	-0.138 	0.197 	-0.192 	-0.020 	-0.443 	-0.039 	0.350 	0.106 	0.038 	0.430 	-0.170 	-0.159 	-0.036 	0.170 	0.051 	0.054 	-0.025 	-0.183 	0.033 	-0.005 	0.184 	0.068 	-0.143 	0.071 	-0.422 	0.217 	0.288 	-0.607 	0.048 	0.456 	0.187 	-0.132 	-0.145 	0.463 	0.213 	-0.040 	-0.040 	-0.053 	-0.427 	-0.477 	-0.007 	0.235 	0.142 	-0.022 	-0.223
            ];
        W_prime = [
            1.988 	0.462 	1.802 	1.377 	1.759 	2.191 	3.148 	2.329 	1.340 	1.155 	3.126 	2.303 	0.200 	0.210 	0.107 	1.925 	1.504 	0.222 	1.074 	2.613 	2.325 	1.633 	1.803 	3.066 	0.205 	1.178 	0.272 	1.380 	0.872 	0.060 	1.771 	2.899 	1.704 	0.981 	0.091 	1.024 	0.807 	2.097 	1.042 	1.601 	5.397 	0.831 	1.365 	1.186 	2.824 	0.074 	1.188 	2.187 	0.918 	1.335 	1.365 	0.942 	2.698 	0.678
            ];
        b = [
            0.413 	0.110 	-1.073 	0.456 	0.438 	0.386 	-0.581 	-0.306 	1.392 	-0.257 	-0.854 	0.264 	-2.048 	-1.706 	2.223 	0.389 	-1.757 	2.227 	-0.049 	0.456 	-0.195 	-0.685 	0.892 	4.808 	-1.811 	-1.438 	0.643 	1.521 	-1.181 	-2.358 	-2.045 	0.744 	-1.203 	0.190 	3.463 	-0.277 	-0.069 	2.261 	1.157 	0.469 	1.013 	-1.376 	-0.127 	-0.253 	-0.575 	1.610 	1.381 	-0.915 	0.673 	-0.922 	0.099 	0.205 	-1.848 	-0.618
            ];
        b_prime = -0.316;
    case 'H-V'
        W = [
            1.818 	6.016 	-0.615 	-3.114 	-2.906 	4.869 	-4.724 	1.262 	-2.584 	2.374 	0.110 	-0.721 	-2.297 	-6.052 	-0.027 	-2.094 	-1.192 	-2.512 	2.287 	-1.597 	-1.076 	-2.205 	-2.668 	2.807 	1.994 	-1.132 	2.132 	0.689 	2.232 	0.087 	1.679 	-0.050 	0.130 	-0.555 	1.961 	-1.564 	-0.192 	1.019 	0.017 	0.128 	2.491 	3.616 	0.344 	1.965
            -0.045 	0.017 	0.070 	0.101 	0.158 	-0.067 	0.059 	0.096 	0.483 	0.012 	0.043 	0.155 	0.565 	-0.029 	-0.084 	0.078 	-0.006 	0.119 	-0.325 	0.035 	0.065 	-0.157 	0.031 	-0.213 	0.353 	0.037 	-0.121 	0.038 	-0.018 	-0.117 	-0.076 	-0.037 	-0.253 	-0.066 	0.010 	-0.035 	0.158 	-0.043 	0.038 	0.040 	-0.112 	-0.091 	-0.028 	0.152
            1.148 	-5.827 	0.904 	0.400 	-0.221 	1.053 	-1.000 	3.103 	2.268 	-1.656 	-4.725 	0.252 	-0.367 	5.893 	2.150 	0.220 	1.642 	1.161 	0.274 	2.511 	1.247 	0.079 	1.642 	-1.312 	-1.429 	2.738 	1.300 	1.256 	1.601 	-0.207 	-1.075 	3.865 	-6.173 	-1.680 	2.537 	1.557 	-1.244 	-2.933 	-2.916 	-6.380 	-0.309 	0.271 	-0.621 	0.001
            0.050 	0.025 	-0.313 	0.095 	-0.043 	-0.035 	0.026 	-0.056 	-0.193 	0.024 	0.027 	0.021 	-0.057 	-0.036 	0.097 	0.161 	-0.510 	0.041 	0.062 	1.267 	-0.421 	0.056 	-0.024 	-0.072 	-0.008 	0.049 	0.153 	-0.017 	-0.057 	-0.121 	-0.023 	0.002 	0.134 	0.041 	0.003 	0.042 	-0.081 	-0.035 	-0.064 	0.267 	-0.122 	0.019 	0.223 	-0.087
            ];
        W_prime = [
            -2.276 	1.766 	1.397 	1.726 	2.334 	1.556 	1.687 	0.334 	0.157 	2.535 	1.527 	1.718 	0.549 	1.732 	1.565 	2.576 	0.380 	1.075 	1.945 	0.018 	0.402 	1.883 	2.055 	0.235 	0.309 	1.273 	0.866 	1.901 	0.847 	1.160 	3.453 	3.473 	0.083 	0.969 	0.314 	1.999 	0.647 	1.153 	2.817 	0.353 	4.294 	0.802 	3.060 	1.810
            ];
        b = [
            1.588 	-0.209 	0.798 	0.063 	-1.199 	-3.708 	3.626 	3.208 	0.777 	-1.378 	-2.167 	-0.185 	-0.925 	0.242 	1.262 	0.131 	0.364 	0.292 	0.995 	0.097 	-0.857 	0.669 	1.472 	2.656 	0.126 	-1.637 	1.888 	-0.049 	1.994 	-0.147 	-0.204 	1.962 	4.791 	-0.043 	-3.391 	0.523 	-0.407 	1.611 	-1.698 	-3.966 	-0.082 	1.420 	-0.296 	-0.570
            ];
        b_prime = 1.078;
    case 'V-V'
        W = [
            -0.246 	0.055 	-1.179 	-0.558 	-1.851 	-0.022 	-5.369 	-1.036 	-3.271 	0.777 	-4.944 	-2.010 	-0.167 	5.425 	-0.817 	-5.547 	-3.270 	0.229 	0.819 	-0.204 	-1.868 	1.779 	0.967 	5.331 	3.635 	1.109 	-5.359 	3.037 	1.301 	-3.312 	0.989 	3.443 	2.064 	-1.582 	4.504 	0.561 	0.499 	-2.602 	1.293 	-0.201 	0.486 	-1.576
            0.120 	-0.077 	0.160 	0.499 	-0.075 	0.058 	0.146 	-0.091 	0.329 	0.050 	0.194 	-0.514 	0.225 	-0.145 	-0.008 	0.123 	-0.163 	-0.016 	0.152 	0.163 	0.418 	-0.217 	0.175 	-0.098 	-0.010 	-0.141 	0.153 	-0.337 	-0.114 	0.088 	0.153 	0.332 	0.269 	-0.138 	-0.175 	-0.104 	0.118 	-0.101 	-0.225 	-0.267 	-0.019 	0.136
            1.534 	4.423 	1.260 	-1.522 	-1.582 	-4.441 	-0.028 	0.808 	-1.043 	-0.332 	5.149 	2.687 	1.487 	1.273 	2.948 	-0.625 	3.079 	1.607 	2.755 	1.318 	1.825 	-0.745 	1.301 	0.050 	-3.302 	-1.256 	-1.760 	0.891 	-0.986 	2.476 	0.503 	-3.220 	-1.688 	-0.691 	-4.885 	-1.250 	3.171 	0.398 	-0.530 	1.313 	-2.063 	1.155
            -0.382 	-0.110 	-0.328 	-0.202 	0.094 	0.147 	0.109 	-0.106 	-0.079 	-0.037 	0.161 	0.214 	0.504 	-0.018 	-0.006 	-0.001 	-0.236 	-0.299 	0.140 	0.438 	-0.612 	-0.089 	-0.344 	-0.119 	0.409 	-0.009 	0.032 	0.093 	0.237 	0.109 	0.071 	0.050 	-0.122 	-0.064 	-0.125 	0.311 	-0.033 	0.031 	-0.098 	0.792 	0.019 	0.085
            ];
        W_prime = [
            1.255 	1.978 	2.175 	0.133 	0.357 	1.976 	1.464 	1.910 	0.989 	3.928 	2.449 	0.808 	-0.732 	2.457 	0.699 	1.192 	3.851 	0.675 	0.216 	1.290 	0.547 	-1.501 	0.562 	1.436 	1.576 	3.353 	1.328 	1.141 	1.821 	0.819 	1.868 	2.127 	0.588 	1.235 	2.952 	3.255 	0.341 	0.633 	2.042 	0.088 	1.920 	3.127
            ];
        b = [
            -0.431 	2.485 	-0.583 	-0.377 	1.134 	-2.518 	-3.299 	-0.484 	-2.304 	0.136 	0.267 	1.156 	-1.359 	-4.060 	-2.083 	3.797 	0.411 	-1.716 	-2.585 	-1.308 	0.708 	1.044 	1.551 	3.239 	-0.318 	0.111 	4.287 	2.224 	0.405 	-0.189 	1.156 	-0.350 	0.255 	-1.332 	-0.415 	0.375 	-1.237 	-2.382 	0.473 	0.385 	1.431 	-0.479
            ];
        b_prime = 1.396;
end

%% predict median correlation coefficient
% ensure predictors are in vector form
[n_row,n_col] = size(input_T1);
n_data = n_row*n_col;
x_T1 = reshape(input_T1,n_data,1);
x_Damp1 = 100*reshape(input_Damp1,n_data,1);
x_T2 = reshape(input_T2,n_data,1);
x_Damp2 = 100*reshape(input_Damp2,n_data,1);

% normalize predictors (equation 10)
X_norm = 2*(log([x_T1,x_Damp1,x_T2,x_Damp2])-repmat(X_min,[n_data,1]))./(repmat(X_max-X_min,[n_data,1]))-1;

% make prediction of median correlation coefficient (equation 9)
Y = (2./(1+exp(-2*(X_norm*W+repmat(b,[n_data,1]))))-1)*W_prime'+repmat(b_prime,[n_data,1]);

% make dimension of output consistent with that of inputs
rho50 = reshape(Y,n_row,n_col);

%% predict standard deviation
sigma_z = sigmaRho_SA_SA(input_T1,input_Damp1,input_T2,input_Damp2,typePair);

return


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%subfunction for standard deviation %%%%%%%%%%%%%%%%%%%%%
function sigma_z = sigmaRho_SA_SA(input_T1,input_Damp1,input_T2,input_Damp2,typePair)

X_min = [-4.605 	-0.693 	-4.605 	-0.693];
X_max = [2.303 	3.401 	2.303 	3.401];

% specify coefficients of model
switch typePair
    case 'H-H'
        W = [
            3.340 	-3.574 	0.151 	-15.827 	-1.420 	1.017 	-1.540 	1.823 	6.066 	17.757 	7.533 	3.746 	5.066 	-0.394 	1.210 	-0.651 	1.270 	-1.865 	0.671 	-4.492 	7.275 	3.802 	4.866 	-1.502 	3.161 	-0.300 	3.261 	2.535 	-0.129 	4.368 	0.264 	0.931 	-7.066 	-6.818 	1.369 	-1.578 	1.150 	1.764 	-2.266 	-4.860 	1.118 	-8.676 	-2.952 	6.679 	0.992 	2.780 	3.281 	-2.691 	1.746 	-7.132 	0.707 	-6.427
            -0.096 	0.112 	-0.038 	0.180 	0.010 	0.139 	-0.833 	0.066 	0.736 	-0.163 	1.119 	-0.041 	-0.081 	0.800 	0.025 	-1.087 	0.182 	-1.127 	-0.019 	-0.793 	0.029 	0.013 	-0.215 	-0.002 	-0.082 	0.042 	0.081 	-0.041 	-1.314 	-0.186 	0.718 	0.058 	0.003 	0.497 	-0.066 	-0.009 	0.005 	0.038 	-0.053 	-0.890 	0.204 	0.099 	0.041 	0.901 	0.106 	0.027 	-0.100 	0.548 	-0.075 	0.807 	-0.034 	0.248
            8.146 	0.936 	2.388 	-0.160 	0.647 	9.947 	2.505 	1.774 	3.047 	0.179 	3.149 	-3.303 	-0.594 	8.965 	0.487 	1.988 	2.448 	2.747 	2.941 	6.173 	0.824 	0.793 	-1.325 	1.168 	-0.664 	-2.695 	4.435 	-1.387 	1.870 	-1.337 	0.165 	5.699 	6.531 	7.800 	1.095 	7.747 	11.732 	0.861 	4.990 	6.873 	7.122 	12.144 	3.041 	3.032 	5.915 	-0.626 	8.333 	8.906 	1.285 	8.316 	3.954 	7.301
            -0.642 	0.167 	0.032 	0.220 	-0.162 	0.026 	-0.152 	0.005 	-0.062 	-0.229 	-0.018 	0.241 	0.224 	-0.228 	-0.115 	-0.251 	0.281 	0.127 	-0.171 	0.258 	0.002 	0.026 	0.346 	0.102 	-0.209 	0.018 	0.150 	0.206 	-0.222 	0.380 	0.300 	0.599 	-0.354 	0.259 	0.694 	-0.085 	0.116 	-0.020 	-0.832 	0.374 	0.169 	-0.420 	-0.156 	-0.044 	0.240 	-0.092 	-0.661 	-3.049 	0.619 	0.379 	-0.354 	0.118
            ];
        W_prime = [
            5.526 	5.816 	4.877 	4.813 	14.582 	2.014 	7.026 	4.889 	4.751 	4.514 	3.020 	6.906 	-0.757 	-0.210 	-11.128 	-9.592 	-0.807 	-1.833 	-12.534 	-3.478 	-3.795 	13.072 	-3.803 	-10.257 	7.258 	2.818 	0.886 	7.422 	4.863 	4.397 	0.179 	2.149 	-3.510 	-9.358 	-3.625 	-7.216 	0.243 	6.210 	1.293 	2.413 	3.932 	4.910 	7.708 	-7.562 	-8.609 	-7.852 	-5.497 	-0.244 	3.403 	3.094 	5.335 	8.751
            ];
        b = [
            2.553 	-0.178 	-2.565 	5.957 	-0.005 	1.686 	1.238 	-1.434 	0.202 	-6.638 	0.695 	0.480 	1.046 	-0.689 	-0.330 	1.856 	-1.548 	1.839 	1.981 	0.332 	6.681 	3.956 	2.285 	-2.182 	0.023 	2.300 	-5.837 	0.564 	2.371 	2.109 	0.118 	1.121 	0.288 	0.078 	1.761 	5.172 	-7.348 	0.584 	1.815 	0.395 	0.730 	2.902 	-0.420 	0.451 	0.927 	2.693 	2.513 	3.967 	1.881 	0.237 	2.244 	0.007
            ];
        b_prime = -7.598;
    case 'H-V'
        W = [
            -1.522 	-3.498 	-6.792 	4.121 	1.189 	3.159 	-3.585 	4.199 	-0.872 	-1.400 	4.856 	-3.389 	-3.739 	-4.850 	2.528 	0.116 	-9.416 	-5.026 	-3.892 	-5.174 	-5.632 	0.262 	-10.302 	-5.899 	-3.493 	14.446 	3.162 	5.692 	1.391 	1.053 	-0.824 	4.578 	0.738 	4.800 	1.301 	15.467 	-0.152 	-0.255 	1.093 	2.399 	1.639 	-1.436 	-5.502 	-1.222 	3.835 	-0.034 	2.604 	-1.405
            0.028 	0.029 	0.186 	-0.049 	-0.233 	-0.025 	0.119 	-0.098 	-0.065 	0.055 	0.143 	0.102 	0.070 	0.040 	-0.089 	0.143 	0.175 	0.336 	0.009 	0.125 	0.142 	0.158 	0.140 	0.129 	0.058 	0.220 	-0.044 	0.034 	0.023 	0.148 	-0.065 	-0.309 	0.132 	-0.002 	0.078 	-0.042 	-0.143 	-0.010 	0.048 	-0.067 	-0.045 	-0.011 	-0.024 	0.145 	-0.012 	0.036 	-0.045 	0.089
            -1.848 	0.186 	-16.537 	-4.302 	22.004 	-0.005 	2.978 	-1.852 	3.288 	3.331 	6.486 	2.842 	3.776 	0.794 	12.122 	11.632 	10.255 	-3.514 	-2.611 	2.295 	2.322 	5.872 	-0.517 	3.311 	-1.752 	-1.347 	1.598 	1.788 	27.841 	-1.081 	-3.881 	3.563 	-0.911 	-2.283 	-2.503 	-0.239 	-9.186 	0.790 	-3.084 	-3.515 	-3.584 	-28.034 	-1.816 	-13.162 	-0.410 	-1.905 	-3.099 	-2.862
            -0.086 	-0.117 	-0.225 	-0.064 	0.282 	0.086 	-0.017 	0.097 	0.158 	-0.191 	0.059 	-0.054 	0.041 	-0.023 	-0.832 	-0.298 	-1.318 	0.061 	-0.056 	-0.124 	-0.131 	-0.158 	-0.045 	-0.157 	-0.013 	-0.122 	0.014 	-0.377 	-0.193 	0.129 	0.040 	-0.045 	0.129 	-0.008 	0.067 	0.053 	0.259 	0.022 	-0.160 	0.055 	0.254 	0.180 	0.390 	-0.104 	0.210 	0.096 	0.018 	-0.467
            ];
        W_prime = [
            0.846 	15.319 	0.066 	5.105 	0.402 	11.714 	1.747 	16.325 	2.721 	4.434 	0.118 	1.621 	7.261 	1.128 	0.069 	2.810 	0.079 	1.107 	0.374 	4.967 	5.995 	3.445 	0.373 	1.872 	5.301 	0.110 	5.932 	3.332 	4.410 	4.537 	1.526 	1.410 	-5.599 	0.687 	0.983 	2.901 	5.341 	5.798 	3.008 	2.394 	2.839 	4.463 	3.390 	0.601 	3.695 	1.832 	3.087 	0.171
            ];
        b = [
            -1.808 	-0.973 	1.730 	0.538 	-19.881 	0.773 	1.083 	0.687 	1.852 	-0.059 	-2.274 	-1.482 	-0.503 	0.792 	6.376 	-8.196 	0.608 	-5.069 	0.563 	-1.331 	-0.695 	-4.092 	-0.208 	-0.579 	1.915 	-11.101 	-1.685 	4.100 	-1.380 	1.572 	2.420 	4.664 	1.174 	-1.543 	1.401 	-17.175 	6.467 	-0.231 	-1.836 	-0.672 	0.171 	1.396 	-3.934 	11.892 	1.247 	-0.358 	0.891 	-0.460
            ];
        b_prime = 1.301;
    case 'V-V'
        W = [
            -9.553 	1.653 	-0.289 	4.793 	10.741 	-0.091 	-2.714 	-0.143 	2.586 	0.501 	-2.555 	2.565 	4.249 	-0.112 	-5.376 	-7.417 	1.185 	-2.755 	0.752 	-0.052 	0.592 	0.990 	1.412 	-0.079 	-9.864 	-0.046 	5.830 	-1.878 	1.282 	-8.335 	1.465 	-1.518 	6.725 	0.745 	-0.206 	10.161 	0.716 	-2.766 	-7.188 	-4.468 	-0.073 	-0.157 	-6.031 	20.594 	14.004 	-0.174 	0.960 	1.808 	-2.677 	-2.204
            -0.153 	0.004 	0.094 	-0.042 	-0.478 	0.343 	0.468 	-0.018 	0.327 	0.099 	0.002 	-0.140 	0.195 	-0.252 	0.009 	-0.203 	-0.048 	0.128 	-0.227 	-0.086 	-0.052 	0.657 	-0.013 	-0.015 	-0.165 	0.017 	0.195 	0.163 	-0.041 	-0.128 	-0.010 	0.001 	1.294 	-0.098 	0.002 	-0.328 	-0.066 	0.555 	0.038 	0.161 	-0.032 	0.001 	-0.010 	0.128 	-0.842 	-0.307 	0.857 	0.463 	0.386 	0.210
            4.876 	-1.342 	-29.431 	4.375 	1.498 	-4.022 	1.173 	4.345 	3.112 	-0.668 	-0.426 	4.504 	2.064 	-0.942 	-3.778 	-2.666 	-13.388 	-4.574 	-4.155 	4.513 	19.847 	-0.202 	1.870 	-17.760 	5.166 	-2.554 	2.333 	-3.282 	-31.655 	3.748 	1.529 	4.400 	-9.029 	-11.559 	-2.598 	1.032 	-8.272 	1.000 	6.563 	8.396 	2.264 	-10.783 	-3.401 	1.172 	1.984 	-0.734 	1.199 	9.388 	1.339 	-3.913
            0.065 	0.050 	-0.001 	-0.016 	0.047 	0.841 	-0.244 	0.700 	0.090 	0.184 	-0.771 	0.070 	0.056 	0.457 	-0.081 	-0.109 	0.131 	-0.064 	-1.522 	0.549 	-0.443 	-0.207 	0.058 	0.012 	0.073 	0.141 	0.073 	0.006 	-0.493 	0.028 	0.023 	-0.171 	-0.146 	0.027 	0.199 	0.041 	0.014 	-0.235 	-0.104 	-1.238 	-0.106 	0.002 	-0.189 	-1.864 	-0.292 	0.451 	-0.029 	0.083 	-0.255 	0.069
            ];
        W_prime = [
            6.359 	-3.664 	-2.071 	10.990 	3.004 	0.844 	9.051 	-5.302 	1.997 	7.770 	-0.280 	-5.344 	-11.337 	-7.148 	19.995 	5.212 	-0.872 	-4.831 	-0.618 	4.666 	-0.250 	-0.351 	8.854 	-9.267 	-4.859 	-8.930 	13.655 	5.890 	-0.760 	-1.651 	-9.777 	-0.611 	-0.383 	-6.554 	-5.182 	-3.677 	6.818 	-4.324 	-0.331 	1.451 	-11.744 	12.223 	-9.766 	-0.126 	0.486 	6.340 	-0.535 	0.801 	-4.918 	-4.392
            ];
        b = [
            -2.522 	-1.275 	-1.059 	5.759 	-9.474 	-3.778 	-0.918 	3.164 	-3.164 	-0.988 	-2.085 	-2.129 	-2.749 	-0.506 	-6.116 	3.847 	2.625 	2.069 	-3.236 	3.120 	-18.746 	0.321 	-0.947 	-2.266 	-2.669 	1.315 	-3.282 	-2.143 	-8.453 	-1.919 	-0.659 	-1.472 	-2.407 	0.504 	2.499 	-8.745 	0.416 	-0.778 	-0.510 	3.873 	-1.529 	-1.215 	-6.618 	17.750 	-14.477 	-0.626 	-2.031 	-10.195 	-1.041 	-2.357
            ];
        b_prime = -0.362;
end

% ensure predictors are in vector form
[n_row,n_col] = size(input_T1);
n_data = n_row*n_col;
x_T1 = reshape(input_T1,n_data,1);
x_Damp1 = 100*reshape(input_Damp1,n_data,1);
x_T2 = reshape(input_T2,n_data,1);
x_Damp2 = 100*reshape(input_Damp2,n_data,1);

% normalize predictors (equation 10)
X_norm = 2*(log([x_T1,x_Damp1,x_T2,x_Damp2])-repmat(X_min,[n_data,1]))./(repmat(X_max-X_min,[n_data,1]))-1;

% make prediction using ANN (equation 9)
Y = (2./(1+exp(-2*(X_norm*W+repmat(b,[n_data,1]))))-1)*W_prime'+repmat(b_prime,[n_data,1]);

% make dimension of output consistent with that of inputs
sigma_z = reshape(exp(Y),n_row,n_col);
return